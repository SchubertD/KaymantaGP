<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml" 
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core" 
                xmlns:ui="http://java.sun.com/jsf/facelets" 
                xmlns:p="http://primefaces.org/ui"
                template="/templates/templateMantenimiento.xhtml">

    <ui:define name="titulo">Proyectos</ui:define> 

    <ui:define name="cuerpo">
        <p:dataTable id="proyectos"  value="#{proyectosBean.proyectos}" var="proyecto" selection="#{proyectosBean.proyectoSeleccionado}" selectionMode="single" scrollable="true" 
                     rowKey="#{proyecto.codigo}" style="width: 1000px" 
                     paginator="true" rows="10"  scrollWidth="false"  paginatorPosition="bottom"
                     paginatorTemplate="  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"  
                     emptyMessage="No se ha registrado ningún Proyecto" rendered="#{not(proyectosBean.enRegistro or 
                                                                                    proyectosBean.enEdicion or 
                                                                                    proyectosBean.enAuditoria or 
                                                                                    proyectosBean.enNuevoDocumento or 
                                                                                    proyectosBean.enEdicionDocumento or 
                                                                                    proyectosBean.enAuditoriaDocumento or 
                                                                                    proyectosBean.enCargaDocumentos or
                                                                                    proyectosBean.enNuevaActividad or
                                                                                    proyectosBean.enEdicionActividad or
                                                                                    proyectosBean.enAuditoriaActividad or
                                                                                    proyectosBean.enActividades or 
                                                                                    proyectosBean.enNuevaSubActividad or
                                                                                    proyectosBean.enEdicionSubActividad or
                                                                                    proyectosBean.enAuditoriaSubActividad or
                                                                                    proyectosBean.enSubActividades or
                                                                                    proyectosBean.enGastos or
                                                                                    proyectosBean.enNuevoGasto or
                                                                                    proyectosBean.enEdicionGasto or
                                                                                    proyectosBean.enAuditoriaGasto or
                                                                                    proyectosBean.enEntregables or
                                                                                    proyectosBean.enNuevoEntregable or
                                                                                    proyectosBean.enEdicionEntregable or
                                                                                    proyectosBean.enAuditoriaEntregable or 
                                                                                    proyectosBean.enNuevoDoc or 
                                                                                    proyectosBean.enEditarDoc or 
                                                                                    proyectosBean.enAuditoriaDoc or 
                                                                                    proyectosBean.enDocumentos or 
                                                                                    proyectosBean.enNuevaReunion or 
                                                                                    proyectosBean.enEdicionReunion or 
                                                                                    proyectosBean.enAuditoriaReunion or 
                                                                                    proyectosBean.enReuniones)}" >

            <p:ajax event="rowSelect" listener="#{proyectosBean.filaSeleccionada(evento)}" update="proyectos"/>
            <p:ajax event="rowUnselect" listener="#{proyectosBean.filaSeleccionada(evento)}" update="proyectos"/>

            <f:facet name="header">
                Proyectos
            </f:facet>
            <p:column headerText="Proyecto" style="width: 130px">
                #{proyecto.nombreProyecto}
            </p:column>
            <p:column headerText="Responsable" style="width: 100px">
                #{proyecto.empleado.nombre}
            </p:column>
            <p:column headerText="Empresa" style="width: 100px">
                #{proyecto.empresa.razonSocial}
            </p:column>
            <p:column headerText="Ubicación Geográfica" style="width: 180px">
                #{proyecto.parroquia.canton.provincia.nombre}
                -
                #{proyecto.parroquia.canton.nombre}
                -
                #{proyecto.parroquia.nombre}
            </p:column>
            <p:column headerText="Avance" style="width: 50px">
                #{proyecto.avance} %
            </p:column>
            <p:column headerText="Fecha Inicio" style="width: 60px">
                <h:outputLabel value="#{proyecto.finicio}">
                    <f:convertDateTime pattern="dd/MM/yyyy" />
                </h:outputLabel>
            </p:column>
            <p:column headerText="Fecha Fin" style="width: 60px">
                <h:outputLabel value="#{proyecto.ffin}">
                    <f:convertDateTime pattern="dd/MM/yyyy" />
                </h:outputLabel>
            </p:column>

            <f:facet name="footer">  
                <p:commandButton  value="Nuevo" update="@form" actionListener="#{proyectosBean.nuevo(evento)}" disabled="#{proyectosBean.disabledNuevo}" icon="ui-icon-document"/>  
                <p:commandButton value="Modificar" update="@form" actionListener="#{proyectosBean.modificar(evento)}" disabled="#{proyectosBean.disabledModificar}" icon="ui-icon-pencil"/>
                <p:commandButton value="Reuniones" update="@form" actionListener="#{proyectosBean.verReuniones(evento)}" disabled="#{proyectosBean.disableAuditoria}" icon="ui-icon-document"/>
                <p:commandButton value="Actividades" update="@form" actionListener="#{proyectosBean.verActividades(evento)}" disabled="#{proyectosBean.disableAuditoria}" icon="ui-icon-close"/>
                <p:commandButton  value="Auditoría" update=":form:mensaje" onsuccess="dlg.show()" actionListener="#{proyectosBean.verAuditoria(evento)}" disabled="#{proyectosBean.disableAuditoria}" icon="ui-icon-document"/>  
                <p:commandButton value="Documentos" update="@form" actionListener="#{proyectosBean.cargaDeDocumentos(evento)}" disabled="#{proyectosBean.disableCargaDocumentos}" icon="ui-icon-document"/>

            </f:facet>
        </p:dataTable>


        <p:dialog id="picture" widgetVar="dlg"  
                  resizable="false" header="Auditoría de Proyectos" modal="true" closable="false" showEffect="clip" hideEffect="clip" style="width: 600px">  
            <p:panelGrid id="mensaje"  columns="2">  
                <p:graphicImage value="/images/footer.png"/>                    
                <p:panelGrid columns="2" rendered="#{proyectosBean.enAuditoria}">

                    <p:outputLabel for="a_codigo" value="Código:"/>
                    <p:outputLabel id="a_codigo" value="#{proyectosBean.proyecto.codigo}" />

                    <p:outputLabel for="a_empresa" value="Nombre de Empresa"/>                
                    <p:outputLabel id="a_empresa" value="#{proyectosBean.proyecto.nombreProyecto}"/>              

                    <p:outputLabel for="usrcre" value="Usuario creación"/>                
                    <p:outputLabel id="usrcre" value="#{proyectosBean.getUsrAuditoria(proyectosBean.proyecto.usrCreacion)}" />              

                    <p:outputLabel for="usrcref" value="Fecha creación:"/>                
                    <h:outputLabel id="usrcref" value="#{proyectosBean.proyecto.fcreacion}">
                        <f:convertDateTime pattern="dd/MM/yyyy" />
                    </h:outputLabel>

                    <p:outputLabel for="usrmod" value="Usuario modificación:"/>                
                    <p:outputLabel id="usrmod" value="#{proyectosBean.getUsrAuditoria(proyectosBean.proyecto.usrModificacion)}"/>              

                    <p:outputLabel for="usrmodf" value="Fecha modificación:"/>                
                    <h:outputLabel id="usrmodf" value="#{proyectosBean.proyecto.fmodificacion}">
                        <f:convertDateTime pattern="dd/MM/yyyy" />
                    </h:outputLabel>

                </p:panelGrid> 
            </p:panelGrid>
            <p:separator/>
            <f:facet name="footer"> 
                <p:commandButton actionListener="#{proyectosBean.cancelar()}" value="Volver" update="@form" icon="ui-icon-back"/>
            </f:facet>
        </p:dialog>


        <p:panel id="panelSeleccion" header="Creación de Proyectos" style="width: 600px"
                 rendered="#{proyectosBean.enRegistro}"> 
            <p:focus context="panelSeleccion"/> 
            <p:panelGrid columns="3" >

                <p:outputLabel for="nombre" value="Nombre Proyecto: "/>
                <p:inputText id="nombre" value="#{proyectosBean.proyecto.nombreProyecto}" required="true"/>
                <p:message for="nombre"/>

                <p:outputLabel for="provinciaB" value="Provincia: " />  
                <p:selectOneMenu id="provinciaB" value="#{proyectosBean.provincia}" label="Provincia" required="true">
                    <f:selectItem itemValue="0" itemLabel="Seleccione una."/>
                    <f:selectItems value="#{proyectosBean.provinciasB}" var="i" itemValue="#{i.codigo}" itemLabel="#{i.nombre}" />
                    <p:ajax update="cantonB"  listener="#{proyectosBean.actualizaCantonesB(evento)}" />  
                </p:selectOneMenu>
                <p:message for="provinciaB"/>


                <p:outputLabel for="cantonB" value="Cantón: " />  
                <p:selectOneMenu id="cantonB" value="#{proyectosBean.canton}" label="Cantón" required="true" >
                    <f:selectItem itemValue="0" itemLabel="Seleccione uno."/>
                    <f:selectItems value="#{proyectosBean.cantonesB}" var="i" itemValue="#{i.pk.codigoCanton}" itemLabel="#{i.nombre}" />
                    <p:ajax update="parroquiaB"  listener="#{proyectosBean.actualizaParroquiasB(evento)}" />
                </p:selectOneMenu> 
                <p:message for="cantonB"/>

                <p:outputLabel for="parroquiaB" value="Parroquia: " />  
                <p:selectOneMenu id="parroquiaB" value="#{proyectosBean.codParroquia}" label="Parroquia" required="true">
                    <f:selectItem itemValue="0" itemLabel="Seleccione una."/>
                    <f:selectItems value="#{proyectosBean.parroquiasB}" var="i" itemValue="#{i.pk.codigoParroquia}" itemLabel="#{i.nombre}" />
                </p:selectOneMenu>
                <p:message for="parroquiaB"/>


                <p:outputLabel for="empresa" value="Empresa: "/>
                <p:selectOneMenu id="empresa" value="#{proyectosBean.empresa}" label="Empresa" required="true" >
                    <f:selectItem itemValue="0" itemLabel="Seleccione una."/>
                    <f:selectItems value="#{proyectosBean.empresas}" var="empresa" itemValue="#{empresa.codigo}" itemLabel="#{empresa.razonSocial}"/>
                </p:selectOneMenu>
                <p:message for="empresa"/>

                <p:outputLabel for="empleado" value="Empleado: "/>
                <p:selectOneMenu id="empleado" value="#{proyectosBean.empleado}" label="Empleado" required="true">
                    <f:selectItem itemValue="0" itemLabel="Seleccione una."/>
                    <f:selectItems value="#{proyectosBean.empleados}" var="empleado" itemValue="#{empleado.codigo}" itemLabel="#{empleado.nombre}"/>
                </p:selectOneMenu>
                <p:message for="empleado"/>

                <p:outputLabel for="finicio" value="Fecha de Inicio: "/>
                <p:calendar id="finicio" value="#{proyectosBean.proyecto.finicio}" label="Fecha de Inicio" showButtonPanel="true" pattern="dd/MM/yyyy" effect="explode" required="true"/>
                <p:message for="finicio"/>

                <p:outputLabel for="festimada" value="Fecha de Estimada de Finalización "/>
                <p:calendar id="festimada" value="#{proyectosBean.proyecto.festimada}" label="Fecha de Estimada de Finalización " showButtonPanel="true" pattern="dd/MM/yyyy" effect="explode" required="true"/>
                <p:message for="festimada"/>

                <p:outputLabel for="fcreacion" value="Fecha de Finalización: "/>
                <p:calendar id="fcreacion" value="#{proyectosBean.proyecto.ffin}" label="Fecha de Finalización: " showButtonPanel="true" pattern="dd/MM/yyyy" effect="explode" required="true"/>
                <p:message for="fcreacion"/>

            </p:panelGrid>
            <f:facet name="footer"> 
                <p:commandButton actionListener="#{proyectosBean.guardar(evento)}" value="Guardar" update="@form" icon="ui-icon-disk"/>
                <p:commandButton actionListener="#{proyectosBean.cancelar()}" immediate="true" value="Cancelar" update="@form" icon="ui-icon-cancel"/>
            </f:facet>
        </p:panel>





        <p:panel id="panelEdicion" header="Edición de Proyectos" style="width: 600px"
                 rendered="#{proyectosBean.enEdicion}"> 
            <p:focus context="panelEdicion"/> 
            <p:panelGrid columns="3">

                <p:outputLabel for="m_nombre" value="Nombre Proyecto: "/>
                <p:inputText id="m_nombre" value="#{proyectosBean.proyecto.nombreProyecto}" required="true"/>
                <p:message for="m_nombre"/>

                <p:outputLabel for="m_provinciaB" value="Provincia: " />  
                <p:selectOneMenu id="m_provinciaB" value="#{proyectosBean.provincia}" label="Provincia" required="true">
                    <f:selectItem itemValue="0" itemLabel="Seleccione una."/>
                    <f:selectItems value="#{proyectosBean.provinciasB}" var="i" itemValue="#{i.codigo}" itemLabel="#{i.nombre}" />
                    <p:ajax update="m_cantonB"  listener="#{proyectosBean.actualizaCantonesB(evento)}" />  
                </p:selectOneMenu>
                <p:message for="m_provinciaB"/>


                <p:outputLabel for="m_cantonB" value="Cantón: " />  
                <p:selectOneMenu id="m_cantonB" value="#{proyectosBean.canton}" label="Cantón" required="true">
                    <f:selectItem itemValue="0" itemLabel="Seleccione uno."/>
                    <f:selectItems value="#{proyectosBean.cantonesB}" var="i" itemValue="#{i.pk.codigoCanton}" itemLabel="#{i.nombre}" />
                    <p:ajax update="m_parroquiaB"  listener="#{proyectosBean.actualizaParroquiasB(evento)}" />
                </p:selectOneMenu>
                <p:message for="m_cantonB"/>

                <p:outputLabel for="m_parroquiaB" value="Parroquia: " />  
                <p:selectOneMenu id="m_parroquiaB" value="#{proyectosBean.codParroquia}" label="Parroquia" required="true">
                    <f:selectItem itemValue="0" itemLabel="Seleccione una."/>
                    <f:selectItems value="#{proyectosBean.parroquiasB}" var="i" itemValue="#{i.pk.codigoParroquia}" itemLabel="#{i.nombre}" />
                </p:selectOneMenu>
                <p:message for="m_parroquiaB"/>


                <p:outputLabel for="m_empresa" value="Empresa: "/>
                <p:selectOneMenu id="m_empresa" value="#{proyectosBean.empresa}" label="Empresa" required="true">
                    <f:selectItem itemValue="0" itemLabel="Seleccione una."/>
                    <f:selectItems value="#{proyectosBean.empresas}" var="empresa" itemValue="#{empresa.codigo}" itemLabel="#{empresa.razonSocial}"/>
                </p:selectOneMenu>
                <p:message for="m_empresa"/>

                <p:outputLabel for="m_empleado" value="Empleado: "/>
                <p:selectOneMenu id="m_empleado" value="#{proyectosBean.empleado}" label="Empleado" required="true">
                    <f:selectItem itemValue="0" itemLabel="Seleccione una."/>
                    <f:selectItems value="#{proyectosBean.empleados}" var="empleado" itemValue="#{empleado.codigo}" itemLabel="#{empleado.nombre}"/>
                </p:selectOneMenu>                                
                <p:message for="m_empleado"/>


                <p:outputLabel for="m_finicio" value="Fecha de Inicio: "/>
                <p:calendar id="m_finicio" value="#{proyectosBean.proyecto.finicio}" label="Fecha de Inicio" showButtonPanel="true" pattern="dd/MM/yyyy" effect="explode" required="true"/>
                <p:message for="m_finicio"/>

                <p:outputLabel for="m_festimada" value="Fecha de Estimada de Finalización "/>
                <p:calendar id="m_festimada" value="#{proyectosBean.proyecto.festimada}" label="Fecha de Estimada de Finalización " showButtonPanel="true" pattern="dd/MM/yyyy" effect="explode" required="true"/>
                <p:message for="m_festimada"/>

                <p:outputLabel for="m_fcreacion" value="Fecha de Finalización: "/>
                <p:calendar id="m_fcreacion" value="#{proyectosBean.proyecto.ffin}" label="Fecha de Finalización: " showButtonPanel="true" pattern="dd/MM/yyyy" effect="explode" required="true"/>
                <p:message for="m_fcreacion"/>

            </p:panelGrid>
            <f:facet name="footer"> 
                <p:commandButton actionListener="#{proyectosBean.guardar(evento)}" value="Guardar" update="@form" icon="ui-icon-disk"/>
                <p:commandButton actionListener="#{proyectosBean.cancelar()}" immediate="true" value="Cancelar" update="@form" icon="ui-icon-cancel"/>
            </f:facet>
        </p:panel>

        <!--REUNIONES-->
        <!--PANEL-->
        <p:dataTable id="reuniones"  value="#{proyectosBean.reuniones}" var="reunion" selection="#{proyectosBean.reunionSeleccionado}" selectionMode="single" scrollable="true" 
                     rowKey="#{reunion.pk}" style="width: 800px" 
                     paginator="true" rows="10"  scrollWidth="false"  paginatorPosition="bottom"
                     paginatorTemplate="  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"  
                     emptyMessage="No se ha registrado ningún gasto" rendered="#{proyectosBean.enReuniones}" >

            <p:ajax event="rowSelect" listener="#{proyectosBean.filaSeleccionadaReunion(evento)}" update="reuniones"/>
            <p:ajax event="rowUnselect" listener="#{proyectosBean.filaSeleccionadaReunion(evento)}" update="reuniones"/>

            <f:facet name="header">
                Gastos
            </f:facet>
            <p:column headerText="Sub-Actividad" style="width: 100px">
                #{reunion.proyecto.nombreProyecto}
            </p:column>
            <p:column headerText="Asistentes" style="width: 200px">
                #{reunion.asistentes}
            </p:column>        
            <p:column headerText="Novedades" style="width: 200px">
                #{reunion.novedades} 
            </p:column>
            <p:column headerText="Fecha" style="width: 70px">
                <h:outputLabel value="#{reunion.fecha}">
                    <f:convertDateTime pattern="dd/MM/yyyy" />
                </h:outputLabel>
            </p:column>
            <f:facet name="footer">  
                <p:commandButton  value="Nuevo" update="@form" actionListener="#{proyectosBean.nuevaReunion(evento)}" icon="ui-icon-document"/>  
                <p:commandButton value="Modificar" update="@form" actionListener="#{proyectosBean.modificarReunion(evento)}" disabled="#{proyectosBean.disableBotonesReunion}" icon="ui-icon-pencil"/>
                <p:commandButton  value="Auditoría" update=":form:g_mensaje" onsuccess="dlg4.show()" actionListener="#{proyectosBean.verAuditoriaReunion(evento)}" disabled="#{proyectosBean.disableBotonesReunion}" icon="ui-icon-document"/>
                <p:commandButton value="Volver" update="@form" actionListener="#{proyectosBean.cancelar()}" icon="ui-icon-back"/>
            </f:facet>
        </p:dataTable>  
        <!--//PANEL-->
        <!--//REUNIONES-->
        <!--
        DOCUMENTOS
        -->

        <p:dataTable id="documentos"  value="#{proyectosBean.documentos}" var="documento" selection="#{proyectosBean.documentoSeleccionado}" selectionMode="single" scrollable="true" 
                     rowKey="#{documento.codigo}" style="width: 700px" 
                     paginator="true" rows="10"  scrollWidth="false"  paginatorPosition="bottom"
                     paginatorTemplate="  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"  
                     emptyMessage="No se ha registrado ningún Documento" rendered="#{proyectosBean.enCargaDocumentos}" >

            <p:ajax event="rowSelect" listener="#{proyectosBean.filaSeleccionadaDocumento(evento)}" update="documentos"/>
            <p:ajax event="rowUnselect" listener="#{proyectosBean.filaSeleccionadaDocumento(evento)}" update="documentos"/>

            <f:facet name="header">
                Documentos
            </f:facet>
            <p:column headerText="Documento" style="width: 80px">
                #{documento.nombreDocumento}
            </p:column>
            <p:column headerText="Institución Control" style="width: 100px">
                #{documento.institucionControl.nombre}
            </p:column>
            <p:column headerText="Tipo" style="width: 100px">
                #{documento.tipoDocumento.nombre}
            </p:column> 

            <p:column headerText="Tipo" style="width: 100px">
                #{documento.tipoDocumento.nombre}
            </p:column> 
            <p:column headerText="Fecha de Carga" style="width: 80px">
                <h:outputLabel value="#{documento.fcreacion}">
                    <f:convertDateTime pattern="dd/MM/yyyy" />
                </h:outputLabel>
            </p:column>
            <f:facet name="footer">  
                <p:commandButton  value="Nuevo" update="@form" actionListener="#{proyectosBean.nuevoDocumento(evento)}" disabled="#{proyectosBean.disableNuevoDocumento}" icon="ui-icon-document"/>  
                <p:commandButton value="Modificar" update="@form" actionListener="#{proyectosBean.modificarDocumento(evento)}" disabled="#{proyectosBean.disableEdicionDocumento}" icon="ui-icon-pencil"/>
                <p:commandButton  value="Auditoría" update=":form:d_mensaje" onsuccess="dlg1.show()" actionListener="#{proyectosBean.verAuditoriaDocumento(evento)}" disabled="#{proyectosBean.disableAuditoriaDocumento}" icon="ui-icon-document"/>
                <p:commandButton value="Volver" update="@form" actionListener="#{proyectosBean.cancelar()}" icon="ui-icon-back"/>
            </f:facet>
        </p:dataTable>




        <p:panel id="nuevoDocumento" header="Nuevos Documentos" style="width: 800px"
                 rendered="#{proyectosBean.enNuevoDocumento}"> 
            <p:focus context="nuevoDocumento"/> 
            <p:panelGrid columns="3" >  

                <p:outputLabel for="institucionControl" value="Institucion Control "/>
                <p:selectOneMenu id="institucionControl" value="#{proyectosBean.instControl}" requiredMessage="Es obligatorio seleccionar una Institución de Control" label="Institucion de Control" required="true">
                    <f:selectItem itemValue="0" itemLabel="Seleccione una."/>
                    <f:selectItems value="#{proyectosBean.institucionesControl}" var="i" itemValue="#{i.codigo}" itemLabel="#{i.nombre}"/>
                </p:selectOneMenu>
                <p:message for="institucionControl"/>

                <p:outputLabel for="tipoDocumento" value="Tipo Documento"/>
                <p:selectOneMenu id="tipoDocumento" value="#{proyectosBean.tipoDoc}" label="Tipo Documento" requiredMessage="Es obligatorio seleccionar un tipo de documento" required="true">
                    <f:selectItem itemValue="0" itemLabel="Seleccione una."/>
                    <f:selectItems value="#{proyectosBean.tipoDocumento}" var="td" itemValue="#{td.codigo}" itemLabel="#{td.nombre}"/>
                </p:selectOneMenu>
                <p:message for="tipoDocumento"/>

                <p:outputLabel for="archivoUP" value="Archivo:"/>
                <p:column>
                    <p:fileUpload id="archivoUP" multiple="false" invalidFileMessage="Este archivo no esta soportado para este documento" invalidSizeMessage="El tamaño del documento ha exedido los límites" fileUploadListener="#{proyectosBean.subirDocumento}"       
                                  mode="advanced"  sizeLimit="90000000" dragDropSupport="true"  auto="false" required="true" 
                                  label="Selección de Archivo" update="guardarDoc" cancelLabel="Cancelar" uploadLabel="Subir"  style="width: 600px; font-size: 12px" allowTypes="/(\.|\/)(doc|docx|pdf|png)$/"/>
                    <p:growl id="msgError" showDetail="true"/> 
                </p:column>
                <p:message for="archivoUP"/>
            </p:panelGrid>
            <f:facet name="footer"> 
                <p:commandButton id="guardarDoc" value="Guardar" update="@form"  icon="ui-icon-disk" 
                                 actionListener="#{proyectosBean.cargarDocumento(evento)}" disabled="#{proyectosBean.disableGuardarDocumento}" />
                <p:commandButton value="Cancelar" update="@form" icon="ui-icon-cancel"
                                 actionListener="#{proyectosBean.cancelar()}" immediate="true"/>
            </f:facet>

        </p:panel>


        <p:panel id="edicionDocumento" header="Nuevos Documentos" style="width: 800px"
                 rendered="#{proyectosBean.enEdicionDocumento}"> 
            <p:focus context="edicionDocumento"/> 
            <p:panelGrid columns="3" >  

                <p:outputLabel for="m_institucionControl" value="Institucion Control "/>
                <p:selectOneMenu id="m_institucionControl" value="#{proyectosBean.instControl}" requiredMessage="Es obligatorio seleccionar una Institución de Control" label="Institucion de Control" required="true">
                    <f:selectItem itemValue="0" itemLabel="Seleccione una."/>
                    <f:selectItems value="#{proyectosBean.institucionesControl}" var="i" itemValue="#{i.codigo}" itemLabel="#{i.nombre}"/>
                </p:selectOneMenu>
                <p:message for="m_institucionControl"/>

                <p:outputLabel for="m_tipoDocumento" value="Tipo Documento"/>
                <p:selectOneMenu id="m_tipoDocumento" value="#{proyectosBean.tipoDoc}" label="Tipo Documento" requiredMessage="Es obligatorio seleccionar un tipo de documento" required="true">
                    <f:selectItem itemValue="0" itemLabel="Seleccione una."/>
                    <f:selectItems value="#{proyectosBean.tipoDocumento}" var="td" itemValue="#{td.codigo}" itemLabel="#{td.nombre}"/>
                </p:selectOneMenu>
                <p:message for="m_tipoDocumento"/>

                <p:outputLabel for="m_nom_documento" value="Documento Cargado: "/>
                <p:outputLabel id="m_nom_documento" value="#{proyectosBean.documento.nombreDocumento}"/>
                <p:message for="m_nom_documento"/>

                <p:outputLabel for="m_archivoUP" value="Nueva Versión Documento:"/>
                <p:column>
                    <p:fileUpload id="m_archivoUP" multiple="false" invalidFileMessage="Este archivo no esta soportado para este documento" invalidSizeMessage="El tamaño del documento ha exedido los límites" fileUploadListener="#{proyectosBean.subirDocumentoModificado}"       
                                  mode="advanced"  sizeLimit="90000000" dragDropSupport="true"  auto="false" required="true" 
                                  label="Selección de Archivo" update="m_guardarDoc" cancelLabel="Cancelar" uploadLabel="Subir"  style="width: 600px; font-size: 12px" allowTypes="/(\.|\/)(doc|docx|pdf|png)$/"/>
                    <p:growl id="m_msgError" showDetail="true"/> 
                </p:column>
                <p:message for="m_archivoUP"/>
            </p:panelGrid>
            <f:facet name="footer"> 
                <p:commandButton id="m_guardarDoc" value="Guardar" update="@form"  icon="ui-icon-disk" 
                                 actionListener="#{proyectosBean.cargarDocumento(evento)}" disabled="#{proyectosBean.disableGuardarDocumento}" />
                <p:commandButton value="Cancelar" update="@form" icon="ui-icon-cancel"
                                 actionListener="#{proyectosBean.cancelar()}" immediate="true"/>
            </f:facet>

        </p:panel>

        <!--AUDITORIA-->
        <p:dialog id="d_picture" widgetVar="dlg1"  
                  resizable="false" header="Auditoría de Documentos" modal="true" closable="false" showEffect="clip" hideEffect="clip" style="width: 600px">  
            <p:panelGrid id="d_mensaje"  columns="2">  
                <p:graphicImage value="/images/footer.png"/>                    
                <p:panelGrid columns="2" rendered="#{proyectosBean.enAuditoriaDocumento}">

                    <p:outputLabel for="a_d_codigo" value="Código:"/>
                    <p:outputLabel id="a_d_codigo" value="#{proyectosBean.documento.codigo}" />

                    <p:outputLabel for="a_d_empresa" value="Nombre de Documento"/>                
                    <p:outputLabel id="a_d_empresa" value="#{proyectosBean.documento.nombreDocumento}"/>              

                    <p:outputLabel for="a_d_usrcre" value="Usuario creación"/>                
                    <p:outputLabel id="a_d_usrcre" value="#{proyectosBean.getUsrAuditoria(proyectosBean.documento.usrCreacion)}" />              

                    <p:outputLabel for="a_d_usrcref" value="Fecha creación:"/>                
                    <h:outputLabel id="a_d_usrcref" value="#{proyectosBean.documento.fcreacion}">
                        <f:convertDateTime pattern="dd/MM/yyyy" />
                    </h:outputLabel>

                    <p:outputLabel for="a_d_usrmod" value="Usuario modificación:"/>                
                    <p:outputLabel id="a_d_usrmod" value="#{proyectosBean.getUsrAuditoria(proyectosBean.documento.usrModificacion)}"/>              

                    <p:outputLabel for="a_d_usrmodf" value="Fecha modificación:"/>                
                    <h:outputLabel id="a_d_usrmodf" value="#{proyectosBean.documento.fmodificacion}">
                        <f:convertDateTime pattern="dd/MM/yyyy" />
                    </h:outputLabel>

                </p:panelGrid> 
            </p:panelGrid>
            <p:separator/>
            <f:facet name="footer"> 
                <p:commandButton actionListener="#{proyectosBean.cancelar()}" value="Volver" update="@form" icon="ui-icon-back"/>
            </f:facet>
        </p:dialog>
        <!--
       DOCUMENTOS
        -->


        <!--
        ACTIVIDADES N1
        -->

        <!--AUDITORIA-->
        <p:dialog id="act_picture" widgetVar="dlg2"  
                  resizable="false" header="Auditoría de Actividades" modal="true" closable="false" showEffect="clip" hideEffect="clip" style="width: 600px">  
            <p:panelGrid id="act_mensaje"  columns="2">  
                <p:graphicImage value="/images/footer.png"/>                    
                <p:panelGrid columns="2" rendered="#{proyectosBean.enAuditoriaActividad}">

                    <p:outputLabel for="act_d_codigo" value="Código:"/>
                    <p:outputLabel id="act_d_codigo" value="#{proyectosBean.actividad.codigo}" />

                    <p:outputLabel for="act_d_empresa" value="Nombre de Documento"/>                
                    <p:outputLabel id="act_d_empresa" value="#{proyectosBean.actividad.nombreActividad}"/>              

                    <p:outputLabel for="act_d_usrcre" value="Usuario creación"/>                
                    <p:outputLabel id="act_d_usrcre" value="#{proyectosBean.getUsrAuditoria(proyectosBean.actividad.usrCreacion)}" />              

                    <p:outputLabel for="act__d_usrcref" value="Fecha creación:"/>                
                    <h:outputLabel id="act__d_usrcref" value="#{proyectosBean.actividad.fcreacion}">
                        <f:convertDateTime pattern="dd/MM/yyyy" />
                    </h:outputLabel>

                    <p:outputLabel for="act__d_usrmod" value="Usuario modificación:"/>                
                    <p:outputLabel id="act__d_usrmod" value="#{proyectosBean.getUsrAuditoria(proyectosBean.actividad.usrModificacion)}"/>              

                    <p:outputLabel for="act__d_usrmodf" value="Fecha modificación:"/>                
                    <h:outputLabel id="act__d_usrmodf" value="#{proyectosBean.actividad.fmodificacion}">
                        <f:convertDateTime pattern="dd/MM/yyyy" />
                    </h:outputLabel>

                </p:panelGrid> 
            </p:panelGrid>
            <p:separator/>
            <f:facet name="footer"> 
                <p:commandButton actionListener="#{proyectosBean.cancelar()}" value="Volver" update="@form" icon="ui-icon-back"/>
            </f:facet>
        </p:dialog>
        <!--Auditoria Actividades-->

        <!--ACTIVIDADES-->


        <p:dataTable id="actividades"  value="#{proyectosBean.actividades}" var="actividad" selection="#{proyectosBean.actividadSeleccionada}" selectionMode="single" scrollable="true" 
                     rowKey="#{actividad.codigo}" style="width: 800px" 
                     paginator="true" rows="10"  scrollWidth="false"  paginatorPosition="bottom"
                     paginatorTemplate="  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"  
                     emptyMessage="No se ha registrado ninguna Actividad" rendered="#{proyectosBean.enActividades}" >

            <p:ajax event="rowSelect" listener="#{proyectosBean.filaSeleccionadaActividad(evento)}" update="actividades"/>
            <p:ajax event="rowUnselect" listener="#{proyectosBean.filaSeleccionadaActividad(evento)}" update="actividades"/>

            <f:facet name="header">
                Actividades
            </f:facet>
            <p:column headerText="Actividad" style="width: 80px">
                #{actividad.nombreActividad}
            </p:column>
            <p:column headerText="Proyecto" style="width: 100px">
                #{actividad.proyecto.nombreProyecto}
            </p:column>        
            <p:column headerText="Avance" style="width: 100px">
                #{actividad.avance} %
            </p:column>
            <p:column headerText="Fecha de Carga" style="width: 80px">
                <h:outputLabel value="#{actividad.fcreacion}">
                    <f:convertDateTime pattern="dd/MM/yyyy" />
                </h:outputLabel>
            </p:column>
            <f:facet name="footer">  
                <p:commandButton  value="Nuevo" update="@form" actionListener="#{proyectosBean.nuevoActividad(evento)}" disabled="#{proyectosBean.disableNuevaActividad}" icon="ui-icon-document"/>  
                <p:commandButton value="Modificar" update="@form" actionListener="#{proyectosBean.modificarActividad(evento)}" disabled="#{proyectosBean.disableModificarActividad}" icon="ui-icon-pencil"/>
                <p:commandButton value="Sub-Actividades" update="@form" actionListener="#{proyectosBean.verSubActividades(evento)}" disabled="#{proyectosBean.disableAuditoriaActividad}" icon="ui-icon-close"/>
                <p:commandButton  value="Auditoría" update=":form:act_mensaje" onsuccess="dlg2.show()" actionListener="#{proyectosBean.verAuditoriaActividad(evento)}" disabled="#{proyectosBean.disableAuditoriaActividad}" icon="ui-icon-document"/>
                <p:commandButton value="Volver" update="@form" actionListener="#{proyectosBean.cancelar()}" icon="ui-icon-back"/>

            </f:facet>
        </p:dataTable>        
        <!--
       ACTIVIDADES N1
        -->

        <!--NUEVA ACTIVIDAD-->
        <p:panel id="nuevoActividad" header="Nueva Actividad" style="width: 800px"
                 rendered="#{proyectosBean.enNuevaActividad}"> 
            <p:focus context="nuevoActividad"/> 
            <p:panelGrid columns="3" >  

                <p:outputLabel for="act_proyecto" value="Proyecto: "/>
                <p:inputText id="act_proyecto" value="#{proyectosBean.proyecto.nombreProyecto}" required="true" readonly="true"/>
                <p:message for="act_proyecto"/>

                <p:outputLabel for="act_nombre" value="Nombre Actividad: "/>
                <p:inputText id="act_nombre" value="#{proyectosBean.actividad.nombreActividad}" required="true"/>
                <p:message for="act_nombre"/>
            </p:panelGrid>
            <f:facet name="footer"> 
                <p:commandButton actionListener="#{proyectosBean.guardarActividad(evento)}" value="Guardar" update="@form" icon="ui-icon-disk"/>
                <p:commandButton actionListener="#{proyectosBean.cancelar()}" immediate="true" value="Cancelar" update="@form" icon="ui-icon-cancel"/>
            </f:facet>
        </p:panel>
        <!-- //NUEVA ACTIVIDAD-->

        <!--EDITAR ACTIVIDAD-->
        <p:panel id="editarActividad" header="Edición Actividad" style="width: 800px"
                 rendered="#{proyectosBean.enEdicionActividad}"> 
            <p:focus context="editarActividad"/> 
            <p:panelGrid columns="3" > 

                <p:outputLabel for="act_m_proyecto" value="Proyecto: "/>
                <p:inputText id="act_m_proyecto" value="#{proyectosBean.actividad.proyecto.nombreProyecto}" readonly="true"/>
                <p:message for="act_m_proyecto"/> 

                <p:outputLabel for="act_m_nombre" value="Nombre Actividad: "/>
                <p:inputText id="act_m_nombre" value="#{proyectosBean.actividad.nombreActividad}" required="true"/>
                <p:message for="act_m_nombre"/>

            </p:panelGrid>
            <f:facet name="footer"> 
                <p:commandButton actionListener="#{proyectosBean.guardarActividad(evento)}" value="Guardar" update="@form" icon="ui-icon-disk"/>
                <p:commandButton actionListener="#{proyectosBean.cancelar()}" immediate="true" value="Cancelar" update="@form" icon="ui-icon-cancel"/>
            </f:facet>
        </p:panel>
        <!-- //EDITAR ACTIVIDAD-->

        <!--//ACTIVIDADES-->

        <!--SUB-ACTIVIDADES-->
        <!--AUDITORIA SUB-ACTIVIDADES-->
        <p:dialog id="sact_picture" widgetVar="dlg3"  
                  resizable="false" header="Auditoría de Sub-Actividades" modal="true" closable="false" showEffect="clip" hideEffect="clip" style="width: 600px">  
            <p:panelGrid id="sact_mensaje"  columns="2">  
                <p:graphicImage value="/images/footer.png"/>                    
                <p:panelGrid columns="2" rendered="#{proyectosBean.enAuditoriaSubActividad}">

                    <p:outputLabel for="sact_d_codigo" value="Código:"/>
                    <p:outputLabel id="sact_d_codigo" value="#{proyectosBean.subActividad.codigo}" />

                    <p:outputLabel for="sact_d_empresa" value="Nombre de Documento"/>                
                    <p:outputLabel id="sact_d_empresa" value="#{proyectosBean.subActividad.nombreActividad}"/>              

                    <p:outputLabel for="sact_d_usrcre" value="Usuario creación"/>                
                    <p:outputLabel id="sact_d_usrcre" value="#{proyectosBean.getUsrAuditoria(proyectosBean.subActividad.usrCreacion)}" />              

                    <p:outputLabel for="sact__d_usrcref" value="Fecha creación:"/>                
                    <h:outputLabel id="sact__d_usrcref" value="#{proyectosBean.subActividad.fcreacion}">
                        <f:convertDateTime pattern="dd/MM/yyyy" />
                    </h:outputLabel>

                    <p:outputLabel for="sact__d_usrmod" value="Usuario modificación:"/>                
                    <p:outputLabel id="sact__d_usrmod" value="#{proyectosBean.getUsrAuditoria(proyectosBean.subActividad.usrModificacion)}"/>              

                    <p:outputLabel for="sact__d_usrmodf" value="Fecha modificación:"/>                
                    <h:outputLabel id="sact__d_usrmodf" value="#{proyectosBean.subActividad.fmodificacion}">
                        <f:convertDateTime pattern="dd/MM/yyyy" />
                    </h:outputLabel>

                </p:panelGrid> 
            </p:panelGrid>
            <p:separator/>
            <f:facet name="footer"> 
                <p:commandButton actionListener="#{proyectosBean.cancelar()}" value="Volver" update="@form" icon="ui-icon-back"/>
            </f:facet>
        </p:dialog>

        <!--//AUDITORIA SUB-ACTIVIDADES-->

        <!--SUB-ACTIVIDADES PANEL-->


        <p:dataTable id="subActividades"  value="#{proyectosBean.subActividades}" var="subActividad" selection="#{proyectosBean.subActividadSeleccionada}" selectionMode="single" scrollable="true" 
                     rowKey="#{subActividad.codigo}" style="width: 800px" 
                     paginator="true" rows="10"  scrollWidth="false"  paginatorPosition="bottom"
                     paginatorTemplate="  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"  
                     emptyMessage="No se ha registrado ninguna Actividad" rendered="#{proyectosBean.enSubActividades}" >

            <p:ajax event="rowSelect" listener="#{proyectosBean.filaSeleccionadaSubActividad(evento)}" update="subActividades"/>
            <p:ajax event="rowUnselect" listener="#{proyectosBean.filaSeleccionadaSubActividad(evento)}" update="subActividades"/>

            <f:facet name="header">
                Sub-Actividades
            </f:facet>
            <p:column headerText="Proyecto" style="width: 100px">
                #{subActividad.proyecto.nombreProyecto}
            </p:column>
            <p:column headerText="Actividad" style="width: 80px">
                #{subActividad.actividad.nombreActividad}
            </p:column>
            <p:column headerText="Sub-Actividad" style="width: 80px">
                #{subActividad.nombreActividad}
            </p:column>
            <p:column headerText="Avance" style="width: 100px">
                #{subActividad.avance} %
            </p:column>
            <p:column headerText="Fecha de Inicio" style="width: 80px">
                <h:outputLabel value="#{subActividad.fcreacion}">
                    <f:convertDateTime pattern="dd/MM/yyyy" />
                </h:outputLabel>
            </p:column>
            <f:facet name="footer">  
                <p:commandButton  value="Nuevo" update="@form" actionListener="#{proyectosBean.nuevoSubActividad(evento)}" disabled="#{proyectosBean.disableNuevaSubActividad}" icon="ui-icon-document"/>  
                <p:commandButton value="Modificar" update="@form" actionListener="#{proyectosBean.modificarSubActividad(evento)}" disabled="#{proyectosBean.disableModificarSubActividad}" icon="ui-icon-pencil"/>
                <p:commandButton  value="Gastos" update="@form" actionListener="#{proyectosBean.verGastos(evento)}" disabled="#{proyectosBean.disableAuditoriaSubActividad}" icon="ui-icon-close"/>
                <p:commandButton  value="Entregables" update="@form" actionListener="#{proyectosBean.verEntregables(evento)}" disabled="#{proyectosBean.disableAuditoriaSubActividad}" icon="ui-icon-close"/>
                <p:commandButton  value="Auditoría" update=":form:sact_mensaje" onsuccess="dlg3.show()" actionListener="#{proyectosBean.verAuditoriaSubActividad(evento)}" disabled="#{proyectosBean.disableAuditoriaSubActividad}" icon="ui-icon-document"/>
                <p:commandButton value="Volver" update="@form" actionListener="#{proyectosBean.cancelar()}" icon="ui-icon-back"/>

            </f:facet>
        </p:dataTable>        
        <!--//SUB-ACTIVIDADES PANEL-->              


        <!--CREAR SUB-ACTIVIDAD-->
        <p:panel id="nuevoSubActividad" header="Nueva Sub-Actividad" style="width: 800px"
                 rendered="#{proyectosBean.enNuevaSubActividad}"> 
            <p:focus context="nuevoSubActividad"/> 
            <p:panelGrid columns="3" >  

                <p:outputLabel for="sact_proyecto" value="Proyecto: "/>
                <p:inputText id="sact_proyecto" value="#{proyectosBean.proyecto.nombreProyecto}" required="true" readonly="true"/>
                <p:message for="sact_proyecto"/>

                <p:outputLabel for="sact_actividad" value="Actividad: "/>
                <p:inputText id="sact_actividad" value="#{proyectosBean.actividad.nombreActividad}" required="true" readonly="true"/>
                <p:message for="sact_actividad"/>

                <p:outputLabel for="sact_nombre" value="Nombre Sub-Actividad: "/>
                <p:inputText id="sact_nombre" value="#{proyectosBean.subActividad.nombreActividad}" required="true"/>
                <p:message for="sact_nombre"/>

                <p:outputLabel for="sact_f_inicio" value="Fecha Inicio:" />
                <p:calendar id="sact_f_inicio" showButtonPanel="true" pattern="dd/MM/yyyy" value="#{proyectosBean.fechasActividad.finicio}" effect="explode" label="Fecha de Inicio" required="true"/> 
                <p:message for="sact_f_inicio" />

                <p:outputLabel for="sact_f_estimada" value="Fecha Fin Estimada:" />
                <p:calendar id="sact_f_estimada" showButtonPanel="true" pattern="dd/MM/yyyy" value="#{proyectosBean.fechasActividad.festimada}" effect="explode" label="Fecha de Finalización Estimada" required="true"/> 
                <p:message for="sact_f_estimada" />

            </p:panelGrid>
            <f:facet name="footer"> 
                <p:commandButton actionListener="#{proyectosBean.guardarSubActividad(evento)}" value="Guardar" update="@form" icon="ui-icon-disk"/>
                <p:commandButton actionListener="#{proyectosBean.cancelar()}" immediate="true" value="Cancelar" update="@form" icon="ui-icon-cancel"/>
            </f:facet>
        </p:panel>
        <!--//CREAR SUB ACTIVIDAD-->



        <!--CREAR SUB-ACTIVIDAD-->
        <p:panel id="edicionSubActividad" header="Edición Sub-Actividad" style="width: 800px"
                 rendered="#{proyectosBean.enEdicionSubActividad}"> 
            <p:focus context="nuevoSubActividad"/> 
            <p:panelGrid columns="3" >  

                <p:outputLabel for="m_sact_proyecto" value="Proyecto: "/>
                <p:inputText id="m_sact_proyecto" value="#{proyectosBean.subActividad.proyecto.nombreProyecto}" required="true" readonly="true"/>
                <p:message for="m_sact_proyecto"/>

                <p:outputLabel for="m_sact_actividad" value="Actividad: "/>
                <p:inputText id="m_sact_actividad" value="#{proyectosBean.subActividad.actividad.nombreActividad}" required="true" readonly="true"/>
                <p:message for="m_sact_actividad"/>

                <p:outputLabel for="m_sact_nombre" value="Nombre Sub-Actividad: "/>
                <p:inputText id="m_sact_nombre" value="#{proyectosBean.subActividad.nombreActividad}" required="true"/>
                <p:message for="m_sact_nombre"/>

                <p:outputLabel for="m_sact_f_inicio" value="Fecha Inicio:" />
                <p:calendar id="m_sact_f_inicio" showButtonPanel="true" pattern="dd/MM/yyyy" value="#{proyectosBean.fechasActividad.finicio}" effect="explode" label="Fecha de Inicio" required="true"/> 
                <p:message for="m_sact_f_inicio" />

                <p:outputLabel for="m_sact_f_estimada" value="Fecha Fin: " />
                <p:calendar id="m_sact_f_estimada" showButtonPanel="true" pattern="dd/MM/yyyy" value="#{proyectosBean.fechasActividad.festimada}" effect="explode" label="Fecha de Finalización" required="true"/> 
                <p:message for="m_sact_f_estimada" />

            </p:panelGrid>
            <f:facet name="footer"> 
                <p:commandButton actionListener="#{proyectosBean.guardarSubActividad(evento)}" value="Guardar" update="@form" icon="ui-icon-disk"/>
                <p:commandButton actionListener="#{proyectosBean.cancelar()}" immediate="true" value="Cancelar" update="@form" icon="ui-icon-cancel"/>
            </f:facet>
        </p:panel>
        <!--//CREAR SUB ACTIVIDAD-->


        <!--//SUB-ACTIVIDADES-->



        <!--GASTOS-->
        <!--PANEL GASTOS-->
        <p:dataTable id="gastos"  value="#{proyectosBean.gastos}" var="gasto" selection="#{proyectosBean.gastoSeleccionado}" selectionMode="single" scrollable="true" 
                     rowKey="#{gasto.pk}" style="width: 800px" 
                     paginator="true" rows="10"  scrollWidth="false"  paginatorPosition="bottom"
                     paginatorTemplate="  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"  
                     emptyMessage="No se ha registrado ningún gasto" rendered="#{proyectosBean.enGastos}" >

            <p:ajax event="rowSelect" listener="#{proyectosBean.filaSeleccionadaGasto(evento)}" update="gastos"/>
            <p:ajax event="rowUnselect" listener="#{proyectosBean.filaSeleccionadaGasto(evento)}" update="gastos"/>

            <f:facet name="header">
                Gastos
            </f:facet>
            <p:column headerText="Sub-Actividad" style="width: 80px">
                #{gasto.actividad.nombreActividad}
            </p:column>
            <p:column headerText="Tipo de Gasto" style="width: 80px">
                #{gasto.tipoGasto.nombre}
            </p:column>
            <p:column headerText="Valor Planificado" style="width: 100px">
                #{gasto.valorPlan}
            </p:column>        
            <p:column headerText="Valor Real" style="width: 100px">
                #{gasto.valorReal} 
            </p:column>
            <f:facet name="footer">  
                <p:commandButton  value="Nuevo" update="@form" actionListener="#{proyectosBean.nuevoGasto(evento)}" icon="ui-icon-document"/>  
                <p:commandButton value="Modificar" update="@form" actionListener="#{proyectosBean.modificarGasto(evento)}" disabled="#{proyectosBean.disableBotonesGastos}" icon="ui-icon-pencil"/>
                <p:commandButton  value="Auditoría" update=":form:g_mensaje" onsuccess="dlg4.show()" actionListener="#{proyectosBean.verAuditoriaGastos(evento)}" disabled="#{proyectosBean.disableBotonesGastos}" icon="ui-icon-document"/>
                <p:commandButton value="Eliminar" onclick="confirmation.show();" disabled="#{proyectosBean.disableBotonesGastos}" icon="ui-icon-close"/>
                <p:commandButton value="Volver" update="@form" actionListener="#{proyectosBean.cancelar()}" icon="ui-icon-back"/>

            </f:facet>
        </p:dataTable>         
        <!--//PANEL GASTOS-->
        <!--AUDITORIA GASTOS-->
        <p:dialog id="g_picture" widgetVar="dlg4"  
                  resizable="false" header="Auditoría de Gastos" modal="true" closable="false" showEffect="clip" hideEffect="clip" style="width: 600px">  
            <p:panelGrid id="g_mensaje"  columns="2">  
                <p:graphicImage value="/images/footer.png"/>                    
                <p:panelGrid columns="2" rendered="#{proyectosBean.enAuditoriaGasto}">

                    <p:outputLabel for="g_codigo" value="Código:"/>
                    <p:outputLabel id="g_codigo" value="#{proyectosBean.gasto.pk.codigoGasto}" />

                    <p:outputLabel for="g_empresa" value="Nombre de Sub-Actividad"/>                
                    <p:outputLabel id="g_empresa" value="#{proyectosBean.gasto.actividad.nombreActividad}"/>              

                    <p:outputLabel for="g_usrcre" value="Usuario creación"/>                
                    <p:outputLabel id="g_usrcre" value="#{proyectosBean.getUsrAuditoria(proyectosBean.gasto.usrCreacion)}" />              

                    <p:outputLabel for="g_usrcref" value="Fecha creación:"/>                
                    <h:outputLabel id="g_usrcref" value="#{proyectosBean.gasto.fcreacion}">
                        <f:convertDateTime pattern="dd/MM/yyyy" />
                    </h:outputLabel>

                    <p:outputLabel for="g_usrmod" value="Usuario modificación:"/>                
                    <p:outputLabel id="g_usrmod" value="#{proyectosBean.getUsrAuditoria(proyectosBean.gasto.usrModificacion)}"/>              

                    <p:outputLabel for="g_usrmodf" value="Fecha modificación:"/>                
                    <h:outputLabel id="g_usrmodf" value="#{proyectosBean.gasto.fmodificacion}">
                        <f:convertDateTime pattern="dd/MM/yyyy" />
                    </h:outputLabel>

                </p:panelGrid> 
            </p:panelGrid>
            <p:separator/>
            <f:facet name="footer"> 
                <p:commandButton actionListener="#{proyectosBean.cancelar()}" value="Volver" update="@form" icon="ui-icon-back"/>
            </f:facet>
        </p:dialog>


        <!--//AUDITORIA GASTOS-->

        <p:confirmDialog id="confirmDialog" message="¿Seguro desea eliminar?"  
                         header="Eliminación" severity="alert" widgetVar="confirmation">  
            <p:commandButton id="confirm" value="Si, seguro" update="@form " oncomplete="confirmation.hide()"  
                             actionListener="#{proyectosBean.eliminar(evento)}"  />  
            <p:commandButton id="decline" value="No" onclick="confirmation.hide();" type="button" />   

        </p:confirmDialog> 

        <!--CREAR Gasto-->
        <p:panel id="nuevoGasto" header="Nueva Sub-Actividad" style="width: 800px"
                 rendered="#{proyectosBean.enNuevoGasto}"> 
            <p:focus context="nuevoGasto"/> 
            <p:panelGrid columns="3" >  

                <p:outputLabel for="g_proyecto" value="Proyecto: "/>
                <p:inputText id="g_proyecto" value="#{proyectosBean.proyecto.nombreProyecto}" required="true" readonly="true"/>
                <p:message for="g_proyecto"/>

                <p:outputLabel for="g_actividad" value="Actividad: "/>
                <p:inputText id="g_actividad" value="#{proyectosBean.actividad.nombreActividad}" required="true" readonly="true"/>
                <p:message for="g_actividad"/>

                <p:outputLabel for="g_nombre" value="Sub-Actividad: "/>
                <p:inputText id="g_nombre" value="#{proyectosBean.subActividad.nombreActividad}" required="true" readonly="true"/>
                <p:message for="g_nombre"/>

                <p:outputLabel for="g_tipo" value="Tipo Gasto:"/>
                <p:selectOneMenu id="g_tipo" value="#{proyectosBean.tipoGasto}" label="Tipo Gasto" requiredMessage="Es obligatorio seleccionar un tipo de gasto" required="true">
                    <f:selectItem itemValue="0" itemLabel="Seleccione una."/>
                    <f:selectItems value="#{proyectosBean.tiposGasto}" var="tg" itemValue="#{tg.codigo}" itemLabel="#{tg.nombre}"/>
                </p:selectOneMenu>
                <p:message for="g_tipo"/>


                <p:outputLabel for="g_plan" value="Gasto Planeado ($):" />
                <p:inputText id="g_plan"  value="#{proyectosBean.gasto.valorPlan}"  label="Gasto Planeado" required="true">
                </p:inputText>
                <p:message for="g_plan" />


            </p:panelGrid>
            <f:facet name="footer"> 
                <p:commandButton actionListener="#{proyectosBean.guardarGasto(evento)}" value="Guardar" update="@form" icon="ui-icon-disk"/>
                <p:commandButton actionListener="#{proyectosBean.cancelar()}" immediate="true" value="Cancelar" update="@form" icon="ui-icon-cancel"/>
            </f:facet>
        </p:panel>
        <!--//CREAR Gasto-->


        <!--EDITAR Gasto-->
        <p:panel id="editarGasto" header="Modificar Gasto" style="width: 800px"
                 rendered="#{proyectosBean.enEdicionGasto}"> 
            <p:focus context="editarGasto"/> 
            <p:panelGrid columns="3" >  

                <p:outputLabel for="m_g_proyecto" value="Proyecto: "/>
                <p:inputText id="m_g_proyecto" value="#{proyectosBean.gasto.actividad.actividad.proyecto.nombreProyecto}" required="true" readonly="true"/>
                <p:message for="m_g_proyecto"/>

                <p:outputLabel for="m_g_actividad" value="Actividad: "/>
                <p:inputText id="m_g_actividad" value="#{proyectosBean.gasto.actividad.actividad.nombreActividad}" required="true" readonly="true"/>
                <p:message for="m_g_actividad"/>

                <p:outputLabel for="m_g_nombre" value="Sub-Actividad: "/>
                <p:inputText id="m_g_nombre" value="#{proyectosBean.gasto.actividad.nombreActividad}" required="true" readonly="true"/>
                <p:message for="m_g_nombre"/>

                <p:outputLabel for="m_g_tipo" value="Tipo Gasto:"/>
                <p:selectOneMenu id="m_g_tipo" value="#{proyectosBean.tipoGasto}" label="Tipo Gasto" requiredMessage="Es obligatorio seleccionar un tipo de gasto" required="true">
                    <f:selectItem itemValue="0" itemLabel="Seleccione una."/>
                    <f:selectItems value="#{proyectosBean.tiposGasto}" var="tg" itemValue="#{tg.codigo}" itemLabel="#{tg.nombre}"/>
                </p:selectOneMenu>
                <p:message for="m_g_tipo"/>


                <p:outputLabel for="m_g_plan" value="Gasto Planeado ($):" />
                <p:inputText id="m_g_plan"  value="#{proyectosBean.gasto.valorPlan}"  label="Gasto Planeado" required="true">
                </p:inputText>
                <p:message for="m_g_plan" />

                <p:outputLabel for="m_g_real" value="Gasto Real ($):" />
                <p:inputText id="m_g_real"  value="#{proyectosBean.gasto.valorReal}"  label="Gasto Real" required="true">
                </p:inputText>
                <p:message for="m_g_real" />


            </p:panelGrid>
            <f:facet name="footer"> 
                <p:commandButton actionListener="#{proyectosBean.guardarGasto(evento)}" value="Guardar" update="@form" icon="ui-icon-disk"/>
                <p:commandButton actionListener="#{proyectosBean.cancelar()}" immediate="true" value="Cancelar" update="@form" icon="ui-icon-cancel"/>
            </f:facet>
        </p:panel>
        <!--//EDITAR Gasto-->
        <!--//GASTOS-->
        <!--ENTREGABLES-->
        <!--ACTIVIDAD ENTREGABLE PANEL-->
        <p:dataTable id="entregables"  value="#{proyectosBean.actividadEntregables}" var="entregable" selection="#{proyectosBean.actividadEntregableSeleccionado}" selectionMode="single" scrollable="true" 
                     rowKey="#{entregable.pk}" style="width: 800px" 
                     paginator="true" rows="10"  scrollWidth="false"  paginatorPosition="bottom"
                     paginatorTemplate="  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"  
                     emptyMessage="No se ha registrado ningún gasto" rendered="#{proyectosBean.enEntregables}" >

            <p:ajax event="rowSelect" listener="#{proyectosBean.filaSeleccionadaEntregable(evento)}" update="entregables"/>
            <p:ajax event="rowUnselect" listener="#{proyectosBean.filaSeleccionadaEntregable(evento)}" update="entregables"/>

            <f:facet name="header">
                Entregables
            </f:facet>
            <p:column headerText="Sub-Actividad" style="width: 80px">
                #{entregable.actividad.nombreActividad}
            </p:column>
            <p:column headerText="Entregable" style="width: 100px">
                #{entregable.nombreEntregable}
            </p:column> 
            <p:column headerText="Institución Control" style="width: 80px">
                #{entregable.institucionControl.nombre}
            </p:column>                   
            <p:column headerText="Tipo" style="width: 100px">
                #{entregable.tipoEntregable.nombre} 
            </p:column>
            <p:column headerText="" style="width: 40px">
                #{entregable.estado}  
            </p:column>
            <f:facet name="footer">  
                <p:commandButton  value="Nuevo" update="@form" actionListener="#{proyectosBean.nuevaActividadEntregable(evento)}" icon="ui-icon-document"/>  
                <p:commandButton value="Modificar" update="@form" actionListener="#{proyectosBean.modificarEntregable(evento)}" disabled="#{proyectosBean.disableBotonesEntregable}" icon="ui-icon-pencil"/>
                <p:commandButton  value="Documentos" update="@form" actionListener="#{proyectosBean.verDocumentos(evento)}" disabled="#{proyectosBean.disableBotonesEntregable}" icon="ui-icon-close"/>
                <p:commandButton  value="Auditoría" update=":form:ent_mensaje" onsuccess="dlg5.show()" actionListener="#{proyectosBean.verAuditoriaEntregables(evento)}" disabled="#{proyectosBean.disableBotonesEntregable}" icon="ui-icon-document"/>
                <p:commandButton value="Volver" update="@form" actionListener="#{proyectosBean.cancelar()}" icon="ui-icon-back"/>

            </f:facet>
        </p:dataTable> 
        <!--//PANEL-->

        <!--AUDITORIA ENTREGABLES-->
        <p:dialog id="ent_picture" widgetVar="dlg5"  
                  resizable="false" header="Auditoría de Entregable" modal="true" closable="false" showEffect="clip" hideEffect="clip" style="width: 600px">  
            <p:panelGrid id="ent_mensaje"  columns="2">  
                <p:graphicImage value="/images/footer.png"/>                    
                <p:panelGrid columns="2" rendered="#{proyectosBean.enAuditoriaEntregable}">

                    <p:outputLabel for="ent_codigo" value="Código:"/>
                    <p:outputLabel id="ent_codigo" value="#{proyectosBean.actividadEntregable.pk.codigoActividadEntregable}" />

                    <p:outputLabel for="ent_empresa" value="Nombre de Sub-Actividad"/>                
                    <p:outputLabel id="ent_empresa" value="#{proyectosBean.actividadEntregable.actividad.nombreActividad}"/>              

                    <p:outputLabel for="ent_usrcre" value="Usuario creación"/>                
                    <p:outputLabel id="ent_usrcre" value="#{proyectosBean.getUsrAuditoria(proyectosBean.actividadEntregable.usrCreacion)}" />              

                    <p:outputLabel for="ent_usrcref" value="Fecha creación:"/>                
                    <h:outputLabel id="ent_usrcref" value="#{proyectosBean.actividadEntregable.fcreacion}">
                        <f:convertDateTime pattern="dd/MM/yyyy" />
                    </h:outputLabel>

                    <p:outputLabel for="ent_usrmod" value="Usuario modificación:"/>                
                    <p:outputLabel id="ent_usrmod" value="#{proyectosBean.getUsrAuditoria(proyectosBean.actividadEntregable.usrModificacion)}"/>              

                    <p:outputLabel for="ent_usrmodf" value="Fecha modificación:"/>                
                    <h:outputLabel id="ent_usrmodf" value="#{proyectosBean.actividadEntregable.fmodificacion}">
                        <f:convertDateTime pattern="dd/MM/yyyy" />
                    </h:outputLabel>

                </p:panelGrid> 
            </p:panelGrid>
            <p:separator/>
            <f:facet name="footer"> 
                <p:commandButton actionListener="#{proyectosBean.cancelar()}" value="Volver" update="@form" icon="ui-icon-back"/>
            </f:facet>
        </p:dialog>
        <!--//AUDITORIA ENTREGABLE-->
        <!--CREAR ENTREGABLE-->
        <p:panel id="nuevoEntregable" header="Nuevo Entregable" style="width: 800px"
                 rendered="#{proyectosBean.enNuevoEntregable}"> 
            <p:focus context="nuevoEntregable"/> 
            <p:panelGrid columns="3" >  

                <p:outputLabel for="ent_proyecto" value="Proyecto: "/>
                <p:inputText id="ent_proyecto" value="#{proyectosBean.proyecto.nombreProyecto}" required="true" readonly="true"/>
                <p:message for="ent_proyecto"/>

                <p:outputLabel for="ent_actividad" value="Actividad: "/>
                <p:inputText id="ent_actividad" value="#{proyectosBean.actividad.nombreActividad}" required="true" readonly="true"/>
                <p:message for="ent_actividad"/>

                <p:outputLabel for="ent_nombre" value="Sub-Actividad: "/>
                <p:inputText id="ent_nombre" value="#{proyectosBean.subActividad.nombreActividad}" required="true" readonly="true"/>
                <p:message for="ent_nombre"/>

                <p:outputLabel for="ent_icontrol" value="Institución de Control:"/>
                <p:selectOneMenu id="ent_icontrol" value="#{proyectosBean.instControl}" label="Institución Control" requiredMessage="Es obligatorio seleccionar una Institución de Control" required="true">
                    <f:selectItem itemValue="0" itemLabel="Seleccione una."/>
                    <f:selectItems value="#{proyectosBean.institucionesControl}" var="ic" itemValue="#{ic.codigo}" itemLabel="#{ic.nombre}"/>
                </p:selectOneMenu>
                <p:message for="ent_icontrol"/>

                <p:outputLabel for="ent_tipo" value="Tipo: "/>
                <p:selectOneMenu id="ent_tipo" value="#{proyectosBean.tipoEntregable}" label="Tipo" requiredMessage="Es obligatorio seleccionar un Tipo del entregable" required="true">
                    <f:selectItem itemValue="0" itemLabel="Seleccione una."/>
                    <f:selectItems value="#{proyectosBean.tiposEntregable}" var="te" itemValue="#{te.codigo}" itemLabel="#{te.nombre}"/>
                </p:selectOneMenu>
                <p:message for="ent_tipo"/>

                <p:outputLabel for="ent_entregable" value="Entregable: "/>
                <p:inputText id="ent_entregable" value="#{proyectosBean.actividadEntregable.nombreEntregable}" required="true"/>
                <p:message for="ent_entregable"/>

            </p:panelGrid>
            <f:facet name="footer"> 
                <p:commandButton actionListener="#{proyectosBean.guardarEntregables(evento)}" value="Guardar" update="@form" icon="ui-icon-disk"/>
                <p:commandButton actionListener="#{proyectosBean.cancelar()}" immediate="true" value="Cancelar" update="@form" icon="ui-icon-cancel"/>
            </f:facet>
        </p:panel>
        <!--//CREAR ENTREGABLE-->

        <!--CREAR ENTREGABLE-->
        <p:panel id="editarEntregable" header="Editar Entregable" style="width: 800px"
                 rendered="#{proyectosBean.enEdicionEntregable}"> 
            <p:focus context="editarEntregable"/> 
            <p:panelGrid columns="3" >  

                <p:outputLabel for="m_ent_proyecto" value="Proyecto: "/>
                <p:inputText id="m_ent_proyecto" value="#{proyectosBean.actividadEntregable.actividad.actividad.proyecto.nombreProyecto}" required="true" readonly="true"/>
                <p:message for="m_ent_proyecto"/>

                <p:outputLabel for="m_ent_actividad" value="Actividad: "/>
                <p:inputText id="m_ent_actividad" value="#{proyectosBean.actividadEntregable.actividad.actividad.nombreActividad}" required="true" readonly="true"/>
                <p:message for="m_ent_actividad"/>

                <p:outputLabel for="m_ent_nombre" value="Sub-Actividad: "/>
                <p:inputText id="m_ent_nombre" value="#{proyectosBean.actividadEntregable.actividad.nombreActividad}" required="true" readonly="true"/>
                <p:message for="m_ent_nombre"/>

                <p:outputLabel for="m_ent_icontrol" value="Institución de Control:"/>
                <p:selectOneMenu id="m_ent_icontrol" value="#{proyectosBean.instControl}" label="Institución Control" requiredMessage="Es obligatorio seleccionar una Institución de Control" required="true">
                    <f:selectItem itemValue="0" itemLabel="Seleccione una."/>
                    <f:selectItems value="#{proyectosBean.institucionesControl}" var="ic" itemValue="#{ic.codigo}" itemLabel="#{ic.nombre}"/>
                </p:selectOneMenu>
                <p:message for="m_ent_icontrol"/>

                <p:outputLabel for="m_ent_tipo" value="Tipo: "/>
                <p:selectOneMenu id="m_ent_tipo" value="#{proyectosBean.tipoEntregable}" label="Tipo" requiredMessage="Es obligatorio seleccionar un Tipo del entregable" required="true">
                    <f:selectItem itemValue="0" itemLabel="Seleccione una."/>
                    <f:selectItems value="#{proyectosBean.tiposEntregable}" var="te" itemValue="#{te.codigo}" itemLabel="#{te.nombre}"/>
                </p:selectOneMenu>
                <p:message for="m_ent_tipo"/>

                <p:outputLabel for="m_ent_entregable" value="Entregable: "/>
                <p:inputText id="m_ent_entregable" value="#{proyectosBean.actividadEntregable.nombreEntregable}" required="true"/>
                <p:message for="m_ent_entregable"/>

                <p:outputLabel for="m_estado" value="Estado:"/>                
                <p:selectOneMenu id="m_estado" value="#{proyectosBean.actividadEntregable.estado}" label="Estado" required="true">
                    <f:selectItem itemLabel="Inicial" itemValue="I"/>
                    <f:selectItem itemLabel="En proceso" itemValue="P"/>
                    <f:selectItem itemLabel="Finalizado" itemValue="F"/>
                    <f:selectItem itemLabel="Revisado" itemValue="R"/>
                </p:selectOneMenu>
                <p:message for="m_estado" />

            </p:panelGrid>
            <f:facet name="footer"> 
                <p:commandButton actionListener="#{proyectosBean.guardarEntregables(evento)}" value="Guardar" update="@form" icon="ui-icon-disk"/>
                <p:commandButton actionListener="#{proyectosBean.cancelar()}" immediate="true" value="Cancelar" update="@form" icon="ui-icon-cancel"/>
            </f:facet>
        </p:panel>


        <!--ENTREGABLES-->

        <!--DOCUMENTOS-->
        <!--PANEL-->
        <p:dataTable id="docs"  value="#{proyectosBean.documentos}" var="documento" selection="#{proyectosBean.documentoSeleccionado}" selectionMode="single" scrollable="true" 
                     rowKey="#{documento.codigo}" style="width: 1000px" 
                     paginator="true" rows="10"  scrollWidth="false"  paginatorPosition="bottom"
                     paginatorTemplate="  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"  
                     emptyMessage="No se ha registrado ningún Documento" rendered="#{proyectosBean.enDocumentos}" >

            <p:ajax event="rowSelect" listener="#{proyectosBean.filaSeleccionadaDoc(evento)}" update="docs"/>
            <p:ajax event="rowUnselect" listener="#{proyectosBean.filaSeleccionadaDoc(evento)}" update="docs"/>

            <f:facet name="header">
                Documentos
            </f:facet>
            <p:column headerText="Sub-Actividad" style="width: 80px">
                #{proyectosBean.actividadEntregable.actividad.nombreActividad}
            </p:column>
            <p:column headerText="Entregable:" style="width: 80px">
                #{proyectosBean.actividadEntregable.nombreEntregable}
            </p:column>
            <p:column headerText="Documento" style="width: 80px">
                #{documento.nombreDocumento}
            </p:column>                               
            <p:column headerText="Institución Control" style="width: 100px">
                #{documento.institucionControl.nombre}
            </p:column>
            <p:column headerText="Tipo" style="width: 100px">
                #{documento.tipoDocumento.nombre}
            </p:column> 
            <p:column headerText="Fecha de Carga" style="width: 80px">
                <h:outputLabel value="#{documento.fcreacion}">
                    <f:convertDateTime pattern="dd/MM/yyyy" />
                </h:outputLabel>
            </p:column>
            <f:facet name="footer">  
                <p:commandButton  value="Nuevo" update="@form" actionListener="#{proyectosBean.nuevoDoc(evento)}" icon="ui-icon-document"/>  
                <p:commandButton value="Modificar" update="@form" actionListener="#{proyectosBean.modificarDoc(evento)}" disabled="#{proyectosBean.disableBotonesDocumento}" icon="ui-icon-pencil"/>
                <p:commandButton  value="Auditoría" update=":form:doc_mensaje" onsuccess="dlg5.show()" actionListener="#{proyectosBean.verAuditoriaDoc(evento)}" disabled="#{proyectosBean.disableBotonesDocumento}" icon="ui-icon-document"/>
                <p:commandButton value="Volver" update="@form" actionListener="#{proyectosBean.cancelar()}" icon="ui-icon-back"/>
            </f:facet>
        </p:dataTable>
        <!--//PANEL-->
        <!--NUEVO DOC-->
        <p:panel id="nuevoDoc" header="Nuevo Documento" style="width: 800px"
                 rendered="#{proyectosBean.enNuevoDoc}"> 
            <p:focus context="nuevoDoc"/> 
            <p:panelGrid columns="3" >  

                <p:outputLabel for="doc_proyecto" value="Proyecto: "/>
                <p:inputText id="doc_proyecto" value="#{proyectosBean.proyecto.nombreProyecto}" required="true" readonly="true"/>
                <p:message for="doc_proyecto"/>

                <p:outputLabel for="doc_actividad" value="Actividad: "/>
                <p:inputText id="doc_actividad" value="#{proyectosBean.actividad.nombreActividad}" required="true" readonly="true"/>
                <p:message for="doc_actividad"/>


                <p:outputLabel for="doc_nombre" value="Sub-Actividad: "/>
                <p:inputText id="doc_nombre" value="#{proyectosBean.subActividad.nombreActividad}" required="true" readonly="true"/>
                <p:message for="doc_nombre"/>

                <p:outputLabel for="doc_institucionControl" value="Institucion Control "/>
                <p:selectOneMenu id="doc_institucionControl" value="#{proyectosBean.instControl}" requiredMessage="Es obligatorio seleccionar una Institución de Control" label="Institucion de Control" required="true">
                    <f:selectItem itemValue="0" itemLabel="Seleccione una."/>
                    <f:selectItems value="#{proyectosBean.institucionesControl}" var="i" itemValue="#{i.codigo}" itemLabel="#{i.nombre}"/>
                </p:selectOneMenu>
                <p:message for="doc_institucionControl"/>

                <p:outputLabel for="doc_tipoDocumento" value="Tipo Documento"/>
                <p:selectOneMenu id="doc_tipoDocumento" value="#{proyectosBean.tipoDoc}" label="Tipo Documento" requiredMessage="Es obligatorio seleccionar un tipo de documento" required="true">
                    <f:selectItem itemValue="0" itemLabel="Seleccione una."/>
                    <f:selectItems value="#{proyectosBean.tipoDocumento}" var="td" itemValue="#{td.codigo}" itemLabel="#{td.nombre}"/>
                </p:selectOneMenu>
                <p:message for="doc_tipoDocumento"/>

                <p:outputLabel for="archivoUP" value="Archivo:"/>
                <p:column>
                    <p:fileUpload id="doc_archivoUP" multiple="false" invalidFileMessage="Este archivo no esta soportado para este documento" invalidSizeMessage="El tamaño del documento ha exedido los límites" fileUploadListener="#{proyectosBean.subirDocumento}"       
                                  mode="advanced"  sizeLimit="90000000" dragDropSupport="true"  auto="false" required="true" 
                                  label="Selección de Archivo" update="doc_guardarDoc" cancelLabel="Cancelar" uploadLabel="Subir"  style="width: 600px; font-size: 12px" allowTypes="/(\.|\/)(doc|docx|pdf|png)$/"/>
                </p:column>
                <p:message for="doc_archivoUP"/>
            </p:panelGrid>
            <f:facet name="footer"> 
                <p:commandButton id="doc_guardarDoc" value="Guardar" update="@form"  icon="ui-icon-disk" 
                                 actionListener="#{proyectosBean.guardarDocumento(evento)}" disabled="#{proyectosBean.disableGuardarDocumento}" />
                <p:commandButton value="Cancelar" update="@form" icon="ui-icon-cancel"
                                 actionListener="#{proyectosBean.cancelar()}" immediate="true"/>
            </f:facet>

        </p:panel>
        <!--//NUEVO DOC-->
        <!--Auditoria Documento-->
        <p:dialog id="doc_picture" widgetVar="dlg5"  
                  resizable="false" header="Auditoría de Documentos" modal="true" closable="false" showEffect="clip" hideEffect="clip" style="width: 600px">  
            <p:panelGrid id="doc_mensaje"  columns="2">  
                <p:graphicImage value="/images/footer.png"/>                    
                <p:panelGrid columns="2" rendered="#{proyectosBean.enAuditoriaDoc}">

                    <p:outputLabel for="a_doc_codigo" value="Código:"/>
                    <p:outputLabel id="a_doc_codigo" value="#{proyectosBean.documento.codigo}" />


                    <p:outputLabel for="a_doc_empresa" value="Nombre de Documento"/>                
                    <p:outputLabel id="a_doc_empresa" value="#{proyectosBean.documento.nombreDocumento}"/>              

                    <p:outputLabel for="a_doc_usrcre" value="Usuario creación"/>                
                    <p:outputLabel id="a_doc_usrcre" value="#{proyectosBean.getUsrAuditoria(proyectosBean.documento.usrCreacion)}" />              

                    <p:outputLabel for="a_doc_usrcref" value="Fecha creación:"/>                
                    <h:outputLabel id="a_doc_usrcref" value="#{proyectosBean.documento.fcreacion}">
                        <f:convertDateTime pattern="dd/MM/yyyy" />
                    </h:outputLabel>

                    <p:outputLabel for="a_doc_usrmod" value="Usuario modificación:"/>                
                    <p:outputLabel id="a_doc_usrmod" value="#{proyectosBean.getUsrAuditoria(proyectosBean.documento.usrModificacion)}"/>              

                    <p:outputLabel for="a_doc_usrmodf" value="Fecha modificación:"/>                
                    <h:outputLabel id="a_doc_usrmodf" value="#{proyectosBean.documento.fmodificacion}">
                        <f:convertDateTime pattern="dd/MM/yyyy" />
                    </h:outputLabel>

                </p:panelGrid> 
            </p:panelGrid>
            <p:separator/>
            <f:facet name="footer"> 
                <p:commandButton actionListener="#{proyectosBean.cancelar()}" value="Volver" update="@form" icon="ui-icon-back"/>
            </f:facet>
        </p:dialog>
        <!--//Auditoria Documento-->
        <!--Edicion Documento-->
        <p:panel id="edicionDoc" header="Nuevos Documentos" style="width: 800px"
                 rendered="#{proyectosBean.enEditarDoc}"> 
            <p:focus context="edicionDoc"/> 
            <p:panelGrid columns="3" >  

                <p:outputLabel for="m_doc_proyecto" value="Proyecto: "/>
                <p:inputText id="m_doc_proyecto" value="#{proyectosBean.proyecto.nombreProyecto}" required="true" readonly="true"/>
                <p:message for="m_doc_proyecto"/>

                <p:outputLabel for="m_doc_actividad" value="Actividad: "/>
                <p:inputText id="m_doc_actividad" value="#{proyectosBean.actividad.nombreActividad}" required="true" readonly="true"/>
                <p:message for="m_doc_actividad"/>

                <p:outputLabel for="m_doc_nombre" value="Sub-Actividad: "/>
                <p:inputText id="m_doc_nombre" value="#{proyectosBean.subActividad.nombreActividad}" required="true" readonly="true"/>
                <p:message for="m_doc_nombre"/>

                <p:outputLabel for="m_doc_institucionControl" value="Institucion Control "/>
                <p:selectOneMenu id="m_doc_institucionControl" value="#{proyectosBean.instControl}" requiredMessage="Es obligatorio seleccionar una Institución de Control" label="Institucion de Control" required="true">
                    <f:selectItem itemValue="0" itemLabel="Seleccione una."/>
                    <f:selectItems value="#{proyectosBean.institucionesControl}" var="i" itemValue="#{i.codigo}" itemLabel="#{i.nombre}"/>
                </p:selectOneMenu>
                <p:message for="m_doc_institucionControl"/>

                <p:outputLabel for="m_doc_tipoDocumento" value="Tipo Documento"/>
                <p:selectOneMenu id="m_doc_tipoDocumento" value="#{proyectosBean.tipoDoc}" label="Tipo Documento" requiredMessage="Es obligatorio seleccionar un tipo de documento" required="true">
                    <f:selectItem itemValue="0" itemLabel="Seleccione una."/>
                    <f:selectItems value="#{proyectosBean.tipoDocumento}" var="td" itemValue="#{td.codigo}" itemLabel="#{td.nombre}"/>
                </p:selectOneMenu>
                <p:message for="m_doc_tipoDocumento"/>

                <p:outputLabel for="m_doc_nom_documento" value="Documento Cargado: "/>
                <p:outputLabel id="m_doc_nom_documento" value="#{proyectosBean.documento.nombreDocumento}"/>
                <p:message for="m_doc_nom_documento"/>

                <p:outputLabel for="m_doc_archivoUP" value="Nueva Versión Documento:"/>
                <p:column>
                    <p:fileUpload id="m_doc_archivoUP" multiple="false" invalidFileMessage="Este archivo no esta soportado para este documento" invalidSizeMessage="El tamaño del documento ha exedido los límites" fileUploadListener="#{proyectosBean.subirDocumentoModificado}"       
                                  mode="advanced"  sizeLimit="90000000" dragDropSupport="true"  auto="false" required="true" 
                                  label="Selección de Archivo" update="m_doc_guardarDoc" cancelLabel="Cancelar" uploadLabel="Subir"  style="width: 600px; font-size: 12px" allowTypes="/(\.|\/)(doc|docx|pdf|png)$/"/>
                </p:column>
                <p:message for="m_doc_archivoUP"/>
            </p:panelGrid>
            <f:facet name="footer"> 
                <p:commandButton id="m_doc_guardarDoc" value="Guardar" update="@form"  icon="ui-icon-disk" 
                                 actionListener="#{proyectosBean.guardarDocumento(evento)}" disabled="#{proyectosBean.disableGuardarDocumento}" />
                <p:commandButton value="Cancelar" update="@form" icon="ui-icon-cancel"
                                 actionListener="#{proyectosBean.cancelar()}" immediate="true"/>
            </f:facet>

        </p:panel>

        <!--//Edicion Documentos-->
        <!--//DOCUMENTOS-->

    </ui:define>

</ui:composition>
